!function(){"use strict";angular.module("app",["ngRoute","jsonFormatter"])}(),function(){"use strict";angular.module("app").config(["$httpProvider",function(t){}])}(),function(){"use strict";angular.module("app").config(["$locationProvider",function(t){t.html5Mode(!0),t.hashPrefix("")}])}(),function(){"use strict";angular.module("app").run(["$rootScope",function(t){}])}(),function(){"use strict";var t=angular.module("app");!function(){function t(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}var e={x:.09,y:.09,z:.3};t.prototype={randomize:function(){return this.x=1e3*Math.random(),this.y=1e3*Math.random(),this.z=1e3*Math.random(),this},toGrid:function(){return this.x=Math.round(this.x/e.x)*e.x,this.y=Math.round(this.y/e.y)*e.y,this.z=Math.round(this.z/e.z)*e.z,this},toFixed:function(){return this.x=+this.x.toFixed(2),this.y=+this.y.toFixed(2),this.z=+this.z.toFixed(2),this}},t.grid=function(e){for(var n=0;n<e.length;n++)e[n].toGrid().toFixed();t.sort(e)},t.sort=function(t){t.sort(function(t,e){return t.z===e.z?t.x===e.x?t.y===e.y?0:t.y>e.y?1:-1:t.x>e.x?1:-1:t.z>e.z?1:-1})}}();t.controller("RootCtrl",["$scope",function(t){function e(){if(h){d.getByteFrequencyData(h),angular.forEach(A.geometry.vertices,function(t,e){var n=e%c.totalBands,o=h[n],r=o/c.totalBands*2;t.x=c.points[e].x+10*r,t.y=c.points[e].y+10*r,t.z=c.points[e].z+10*r}),A.geometry.verticesNeedUpdate=!0;var t=c.rows,e=c.strength,n=c.groundStrength;angular.forEach(b.geometry.vertices,function(o,r){var i=Math.floor(r/t),a=r-i*t,s=2*Math.abs(a-t/2),u=1-Math.abs(i-t/2)/(t/2),d=1-Math.abs(a-t/2)/(t/2),l=(u+d)/2,f=s%c.totalBands,m=h[f],p=m/c.totalBands*u*2,w=i*t+(a+_)%t,E=c.heightMap[w]/64*n*l+e*p;o.z+=(E-o.z)/(3+3*(1-l))}),_++,b.geometry.verticesNeedUpdate=!0}}function n(){f.begin(),o(),f.end(),requestAnimationFrame(n)}function o(){E&&E.update(),e(),z.render(p,w)}function r(t){t=t.map(function(t){return new THREE.Vector3(t.x,t.y,t.z)});var e=new THREE.CatmullRomCurve3(t),n=new THREE.Geometry;n.vertices=e.getPoints(5e3),C.geometry=n}function i(t){}function a(){function t(t){L={x:t.clientX,y:t.clientY}}function e(t){}function n(t){}function o(t){t.touches.length>1&&(t.preventDefault(),mousePos={x:t.touches[0].pageX,y:t.touches[0].pageY})}function r(t){mousePos={x:windowHalfX,y:windowHalfY}}function i(t){1==t.touches.length&&(t.preventDefault(),mousePos={x:t.touches[0].pageX,y:t.touches[0].pageY})}function a(){H=window.innerWidth,R=window.innerHeight,T=H/2,P=R/2,z.setSize(H,R),w.aspect=H/R,w.updateProjectionMatrix()}window.addEventListener("resize",a,!1),document.addEventListener("mousemove",t,!1),document.addEventListener("mousedown",e,!1),document.addEventListener("mouseup",n,!1),document.addEventListener("touchstart",o,!1),document.addEventListener("touchend",r,!1),document.addEventListener("touchmove",i,!1)}function s(t,e){for(var n=t*e,o=new Uint8Array(n),r=new u,i=1,a=100*Math.random(),s=0;s<4;s++){for(var c=0;c<n;c++){var d=c%t,h=~~(c/t);o[c]+=Math.abs(r.noise(d/i,h/i,a)*i*1.75)}i*=5}return o}function u(){function t(t){return t*t*t*(t*(6*t-15)+10)}function e(t,e,n){return e+t*(n-e)}function n(t,e,n,o){var r=15&t,i=r<8?e:n,a=r<4?n:12==r||14==r?e:o;return(0==(1&r)?i:-i)+(0==(2&r)?a:-a)}for(var o=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)o[256+r]=o[r];return{noise:function(r,i,a){var s=Math.floor(r),u=Math.floor(i),c=Math.floor(a),d=255&s,h=255&u,l=255&c;r-=s,i-=u,a-=c;var f=r-1,m=i-1,p=a-1,w=t(r),E=t(i),y=t(a),v=o[d]+h,g=o[v]+l,x=o[v+1]+l,z=o[d+1]+h,M=o[z]+l,H=o[z+1]+l;return e(y,e(E,e(w,n(o[g],r,i,a),n(o[M],f,i,a)),e(w,n(o[x],r,m,a),n(o[H],f,m,a))),e(E,e(w,n(o[g+1],r,i,p),n(o[M+1],f,i,a-1)),e(w,n(o[x+1],r,m,p),n(o[H+1],f,m,p))))}}}var c={points:[],groundPoints:[],totalBands:256,rows:256,space:10,strength:60,groundStrength:15,heightMap:s(256,256),audioUrl:"audio/rossini-192.mp3"};c.heightMap=s(c.rows,c.rows);var d,h,l,f,m,p,w,E,y,v,g,x,z,M,H,R,T,P,b,A,C,L={x:0,y:0},_=0;!function(){H=window.innerWidth,R=window.innerHeight,v=H/R,T=H/2,P=R/2,y=60,g=1,x=2e4,p=new THREE.Scene,w=new THREE.PerspectiveCamera(y,v,g,x),w.position.z=100,w.position.y=-500,w.lookAt(new THREE.Vector3(0,0,0)),z=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),z.setSize(H,R),z.shadowMap.enabled=!0,M=document.getElementById("scene"),M.appendChild(z.domElement),f=new Stats,M.appendChild(f.dom),a(),E=new THREE.OrbitControls(w,z.domElement)}(),function(){var t,e;e=new THREE.PointsMaterial({color:8947848,size:1,sizeAttenuation:!1}),t=new THREE.Geometry,b=new THREE.Points(t,e),p.add(b);for(var n=c.rows,o=c.space,r=new Array(n*n).fill(null).map(function(t,e){var r=Math.floor(e/n),i=e-r*n,a=1-Math.abs(r-n/2)/(n/2),s=1-Math.abs(i-n/2)/(n/2),u=(a+s)/2,c=1-u;return{x:-o*n/2+o*i,y:-o*n/2+o*r,z:0,color:new THREE.Color(c,c,c)}}),i=0,a=r.length;i<a;){var s=r[i],u=new THREE.Vector3;u.x=s.x,u.y=s.y,u.z=s.z,t.vertices.push(u),i++}t.mergeVertices(),t.verticesNeedUpdate=!0,b.geometry=t,t=new THREE.Geometry,e=new THREE.LineBasicMaterial({color:13421772}),C=new THREE.Line(t,e),t=new THREE.Geometry,e=new THREE.PointsMaterial({color:0,size:2,sizeAttenuation:!1}),A=new THREE.Points(t,e),p.add(A)}(),function(){for(var t=new THREE.Geometry,e=new Array(250).fill(null).map(function(){return{x:1e3*Math.random()-500,y:1e3*Math.random()-500,z:1e3*Math.random()-500}}),n=0,o=e.length;n<o;){var i=e[n],a=new THREE.Vector3;a.x=i.x,a.y=i.y,a.z=i.z,t.vertices.push(a),t.colors.push(new THREE.Color(0,0,0)),n++}t.mergeVertices(),t.verticesNeedUpdate=!0,A.geometry=t,c.points=e,r(e)}(),function(){var t,e,n=window.AudioContext||window.webkitAudioContext;t=null,e=new n,d=e.createAnalyser(),l=new Audio,l.src=c.audioUrl,l.controls=!0,l.addEventListener("canplay",function(){var n;return console.log("audio canplay"),t=e.createMediaElementSource(l),t.connect(d),t.connect(e.destination),d.fftSize=2*c.totalBands,n=d.frequencyBinCount,console.log("bufferLength",n),h=new Uint8Array(n)}),l.play()}(),n();!function(){function t(){this.arms=2,this.stops=5e3,this.revolutions=1.7,this.radius=400,this.sparse=.4,this.dispersion=.6,this.bulge=.6,this.displayOutline=!1,this.randomize=function(){for(var t=0;t<m.__controllers.length;t++){var e=m.__controllers[t];if(e.__min){var n=e.__min+(e.__max-e.__min)*Math.random();this[e.property]=n,e.updateDisplay()}}i(this)},this.armTheta=function(){return 2*Math.PI/this.arms},this.modulus=function(){return Math.pow(2,31)}}new t}()}])}();
//# sourceMappingURL=app.min.js.map
