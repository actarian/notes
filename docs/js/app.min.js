!function(){"use strict";angular.module("app",["ngRoute","jsonFormatter"])}(),function(){"use strict";angular.module("app").config(["$httpProvider",function(n){}])}(),function(){"use strict";angular.module("app").config(["$locationProvider",function(n){n.html5Mode(!0),n.hashPrefix("")}])}(),function(){"use strict";angular.module("app").run(["$rootScope",function(n){}])}(),function(){"use strict";angular.module("app").controller("RootCtrl",["$scope",function(n){function t(n){M.setClearColor(u.colors.background,1),L.ground&&L.ground.material.color.setHex(u.colors.lines),L.groundLines&&L.groundLines.material.color.setHex(u.colors.lines)}function e(){function n(){m.add(o)}function t(){m.remove(o)}function e(){var n=u.rows,t=u.strength,e=u.noiseStrength;angular.forEach(h,function(o,r){var i=Math.floor(r/n),a=r-i*n,s=2*Math.abs(a-n/2),c=1-Math.abs(i-n/2)/(n/2),l=1-Math.abs(a-n/2)/(n/2),h=(c+l)/2,m=s%u.bands,p=d[m],w=p/u.bands*c*2,g=i*n+(a+f)%n,v=u.noiseMap[g]/64*e*h+t*w;o.z+=(v-o.z)/(3+3*(1-h))}),angular.forEach(i,function(n,t){n.geometry.verticesNeedUpdate=!0}),f++}var o,r,i=[];r=new THREE.LineBasicMaterial({color:u.colors.lines}),o=new THREE.Object3D,m.add(o);for(var a=u.rows,s=u.space;i.length<u.rows;){var c=new THREE.Geometry,l=new THREE.Line(c,r);l.points=new Array(a).fill(null),i.push(l),o.add(l)}var h=new Array(a*a).fill(null).map(function(n,t){var e=Math.floor(t/a),o=t-e*a,r=(Math.abs(e-a/2),Math.abs(o-a/2),new THREE.Vector3(-s*a/2+s*o,-s*a/2+s*e,0));return i[o].points[e]=r,i[o].geometry.vertices.push(r),r}),f=0;return{add:n,remove:t,update:e,object:o,material:r}}function o(){d&&(c.getByteFrequencyData(d),L.groundLines.update())}function r(){h.begin(),i(),h.end(),requestAnimationFrame(r)}function i(){w&&w.update(),o(),M.render(m,p)}function a(){function n(n){R={x:n.clientX,y:n.clientY}}function t(n){}function e(n){}function o(n){n.touches.length>1&&(n.preventDefault(),mousePos={x:n.touches[0].pageX,y:n.touches[0].pageY})}function r(n){mousePos={x:windowHalfX,y:windowHalfY}}function i(n){1==n.touches.length&&(n.preventDefault(),mousePos={x:n.touches[0].pageX,y:n.touches[0].pageY})}function a(){b=window.innerWidth,z=window.innerHeight,H=b/2,C=z/2,M.setSize(b,z),p.aspect=b/z,p.updateProjectionMatrix()}window.addEventListener("resize",a,!1),document.addEventListener("mousemove",n,!1),document.addEventListener("mousedown",t,!1),document.addEventListener("mouseup",e,!1),document.addEventListener("touchstart",o,!1),document.addEventListener("touchend",r,!1),document.addEventListener("touchmove",i,!1)}function s(){function n(n){return n*n*n*(n*(6*n-15)+10)}function t(n,t,e){return t+n*(e-t)}function e(n,t,e,o){var r=15&n,i=r<8?t:e,a=r<4?e:12==r||14==r?t:o;return(0==(1&r)?i:-i)+(0==(2&r)?a:-a)}for(var o=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],r=0;r<256;r++)o[256+r]=o[r];return{noise:function(r,i,a){var s=Math.floor(r),u=Math.floor(i),c=Math.floor(a),d=255&s,l=255&u,h=255&c;r-=s,i-=u,a-=c;var f=r-1,m=i-1,p=a-1,w=n(r),g=n(i),v=n(a),y=o[d]+l,E=o[y]+h,M=o[y+1]+h,x=o[d+1]+l,b=o[x]+h,z=o[x+1]+h;return t(v,t(g,t(w,e(o[E],r,i,a),e(o[b],f,i,a)),t(w,e(o[M],r,m,a),e(o[z],f,m,a))),t(g,t(w,e(o[E+1],r,i,p),e(o[b+1],f,i,a-1)),t(w,e(o[M+1],r,m,p),e(o[z+1],f,m,p))))}}}var u={audioUrl:"audio/rossini-192.mp3",colors:{background:1118481,lines:10066329,notes:4473924},bands:256,rows:256,space:10,strength:60,noiseStrength:25};u.points=new Array(2*u.bands).fill(null).map(function(){var n=1e3;return new THREE.Vector3(-n+2e3*Math.random(),-n+2e3*Math.random(),-n+2e3*Math.random())}),u.noiseMap=function(n,t){for(var e=n*t,o=new Uint8Array(e),r=new s,i=1,a=100*Math.random(),u=0;u<4;u++){for(var c=0;c<e;c++){var d=c%n,l=~~(c/n);o[c]+=Math.abs(r.noise(d/i,l/i,a)*i*1.75)}i*=5}return o}(u.rows,u.rows);var c,d,l,h,f,m,p,w,g,v,y,E,M,x,b,z,H,C,L={},R={x:0,y:0};!function(){b=window.innerWidth,z=window.innerHeight,v=b/z,H=b/2,C=z/2,g=60,y=1,E=2e4,m=new THREE.Scene,p=new THREE.PerspectiveCamera(g,v,y,E),p.position.z=100,p.position.y=-500,p.lookAt(new THREE.Vector3(0,0,0)),M=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),M.setSize(b,z),M.setClearColor(u.colors.background,1),M.shadowMap.enabled=!0,x=document.getElementById("scene"),x.appendChild(M.domElement),h=new Stats,x.appendChild(h.dom),a(),w=new THREE.OrbitControls(p,M.domElement)}(),function(){L.groundLines=e()}(),function(){var n,t,e=window.AudioContext||window.webkitAudioContext;n=null,t=new e,c=t.createAnalyser(),l=new Audio,l.src=u.audioUrl,l.controls=!0,l.addEventListener("canplay",function(){var e;return console.log("audio canplay"),n=t.createMediaElementSource(l),n.connect(c),n.connect(t.destination),c.fftSize=2*u.bands,e=c.frequencyBinCount,console.log("bufferLength",e),d=new Uint8Array(e)}),l.play()}(),r();var T=function(){function n(){this.arms=2,this.stops=5e3,this.revolutions=1.7,this.radius=400,this.sparse=.4,this.dispersion=.6,this.bulge=.6,this.displayOutline=!1,this.randomize=function(){for(var n=0;n<f.__controllers.length;n++){var e=f.__controllers[n];if(e.__min){var o=e.__min+(e.__max-e.__min)*Math.random();this[e.property]=o,e.updateDisplay()}}t(this)},this.armTheta=function(){return 2*Math.PI/this.arms},this.modulus=function(){return Math.pow(2,31)}}return new n}();!function(){f=new dat.GUI,f.closed=!0,f.addColor(u.colors,"background").onChange(t),f.addColor(u.colors,"lines").onChange(t),t(T)}()}]);!function(){function n(n,t,e){this.x=n||0,this.y=t||0,this.z=e||0}var t={x:.09,y:.09,z:.3};n.prototype={randomize:function(){return this.x=1e3*Math.random(),this.y=1e3*Math.random(),this.z=1e3*Math.random(),this},toGrid:function(){return this.x=Math.round(this.x/t.x)*t.x,this.y=Math.round(this.y/t.y)*t.y,this.z=Math.round(this.z/t.z)*t.z,this},toFixed:function(){return this.x=+this.x.toFixed(2),this.y=+this.y.toFixed(2),this.z=+this.z.toFixed(2),this}},n.grid=function(t){for(var e=0;e<t.length;e++)t[e].toGrid().toFixed();n.sort(t)},n.sort=function(n){n.sort(function(n,t){return n.z===t.z?n.x===t.x?n.y===t.y?0:n.y>t.y?1:-1:n.x>t.x?1:-1:n.z>t.z?1:-1})}}()}();
//# sourceMappingURL=app.min.js.map
